<!DOCTYPE HTML>
<html>
<head>
    <meta charset="utf-8" />
    <title>Web Profile - Consuming Site</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <style>

      #connect:not([connected]):before {
        content: "Connect a Profile";
      }

      #connect[connected]:before {
        content: "Connected as: " attr(connected);
      }

    </style>
</head>
<body>
    <button id="connect"></button>
</body>

    <script src="https://rawgit.com/Web-Profile/prollyfills/master/web.js"></script>

<script>

var connectButton = document.getElementById('connect');

function onConnect(){
  connectButton.setAttribute('connected', navigator.webProfile.connectedProfile);
  navigator.webProfile.getProfile().then(function(profile){
    document.body.style.background = 'url(' + profile.cover.url + ')';
  })
}

if (navigator.webProfile.connectedProfile) onConnect();

connectButton.addEventListener('click', function(){
  navigator.webProfile.connect().then(function(username){
    onConnect();
  });
})

</script>

</html>
